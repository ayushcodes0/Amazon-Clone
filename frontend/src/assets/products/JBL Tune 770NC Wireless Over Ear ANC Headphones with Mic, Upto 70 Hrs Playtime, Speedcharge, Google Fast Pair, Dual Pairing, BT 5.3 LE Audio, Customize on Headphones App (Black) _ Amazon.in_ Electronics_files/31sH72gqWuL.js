'use strict';mix_d("BrandExperienceCards__expert-reviews:expert-reviews__LIK8fjou","require exports tslib @c/scoped-dom @c/browser-operations @c/aui-feature-detect @c/tracking @c/logger @c/aui-carousel @c/aui-untrusted-ajax @p/A @p/a-modal".split(" "),function(K,A,l,L,M,N,O,P,Q,R,S,T){function m(a){return a&&"object"===typeof a&&"default"in a?a:{"default":a}}function U(a){if(a&&a.__esModule)return a;var b=Object.create(null);a&&Object.keys(a).forEach(function(c){if("default"!==c){var d=Object.getOwnPropertyDescriptor(a,
c);Object.defineProperty(b,c,d.get?d:{enumerable:!0,get:function(){return a[c]}})}});b["default"]=a;return b}var v=m(L),V=m(M),B=m(N),q=m(P),W=m(Q),X=m(R),f=m(S),Y=m(T),r;(function(a){a.MWEB="mWeb";a.MSHOP="mShop";a.DESKTOP="desktop"})(r||(r={}));var C=function(){return B["default"].isSupported("isAmazonApp")},w=function(){return B["default"].isSupported("mobile")},D=function(a,b){return l.__awaiter(void 0,void 0,void 0,function(){var c;return l.__generator(this,function(d){switch(d.label){case 0:return c=
O.createTracking(a,{ref_:b}),[4,c().catch(function(e){q["default"].log("Click tracking remote operation failed: "+e,"WARN")})];case 1:return[2,d.sent()]}})})},E=function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];return a.join("_").slice(0,64)},n;(function(a){a.videoFullScreen="videoFullScreen";a.showSheet="show-sheet";a.publisherHeaderClicked="publisher-header-clicked";a.videoIngressTrigger="videoIngressTrigger"})(n||(n={}));var Z=function(a,b,c){a=a.querySelectorAll(".desktop-publisher-header");
a.length&&(b(n.publisherHeaderClicked,"click",function(d){var e;d=null===(e=d.currentTarget)||void 0===e?void 0:e.getAttribute("popover-content-id");D("publisherClicked",E("erc","p","d",null!==d&&void 0!==d?d:""))}),a.forEach(function(d){c(n.publisherHeaderClicked,d)}))},aa=function(a,b,c){return l.__awaiter(void 0,void 0,void 0,function(){var d,e,k,y,F;return l.__generator(this,function(x){switch(x.label){case 0:return d=a.querySelectorAll(".mobile-publisher-header"),d.length?[4,new Promise(function(g,
p){K(["@c/aui-bottom-sheet"],function(t){g(U(t))},p)})]:[2];case 1:return e=x.sent().default,k=e.create("publisher-bottom-sheet",".publisher-bottom-sheet-empty-div"),[4,k.changeHeight(160)];case 2:return x.sent(),b(n.showSheet,"click",function(g){var p;g=null===(p=g.currentTarget)||void 0===p?void 0:p.getAttribute("sheet-content-id");var t=a.querySelector("#"+g);k.render(function(G){var z;G.innerHTML=(null===t||void 0===t?void 0:t.outerHTML)||"";null===(z=G.querySelector(".publisher-bottom-sheet-content"))||
void 0===z?void 0:z.classList.remove("aok-hidden")});D("publisherHeaderClicked",E("erc","p","m",null!==g&&void 0!==g?g:""));k.show()}),d.forEach(function(g){c(n.showSheet,g)}),y=W["default"].getCarousel(a.getElementsByClassName("_expert-reviews_style_expert-reviews-carousel__3vuHR")[0]),F=a.getElementsByClassName("_expert-reviews_style_expert-reviews-pagination-dots__3J07Z")[0],[4,y.initialized];case 3:return x.sent(),y.on("change:pageNumber",function(g){var p=F.getElementsByTagName("li");p[g.oldPageNumber-
1].classList.remove("a-selected");p[g.newPageNumber-1].classList.add("a-selected")}),[2]}})})},H=function(a,b,c,d,e){void 0===e&&(e=3);e--;X["default"].post(a,{accepts:"*/*",contentType:"application/json;charset=UTF-8",timeout:4E3},b).then(function(k){c(k)}).catch(function(k){0===k.statusCode?q["default"].log("Request has failed with unknown status code. Payload: "+JSON.stringify(b),"ERROR"):0<e?H(a,b,c,d,e):d(k)})},h,u,I,da=function(a){return l.__awaiter(void 0,void 0,void 0,function(){var b;return l.__generator(this,
function(c){b=a.querySelectorAll(".video-containers");if(0==b.length)return[2];ba(b);ca();return[2]})})},ca=function(){H("/vap/ew/componentbuilder",h,function(a){f["default"].$("#vse-expert-reviews-lightbox-container").html(a.responseBody)},function(a){f["default"].trigger("vse:cards:hctp-expert-reviews:componentbuilder:failed");q["default"].log("NilgiriService componentbuilder call has failed.\n        Status code: "+a.statusCode+". Status text: "+a.statusText,"FATAL","expert-reviews")})},J=function(a){var b=
new Map;b.set("asin",a.getAttribute("data-asin"));b.set("videoImageHeight",a.getAttribute("data-videoimageheight"));b.set("videoImageWidth",a.getAttribute("data-videoimagewidth"));b.set("videoImagePhysicalId",a.getAttribute("data-videoimagephysicalid"));b.set("videoImageExtension",a.getAttribute("data-videoimageextension"));b.set("title",a.getAttribute("data-title"));b.set("referenceId",a.getAttribute("data-referenceid"));b.set("videoURL",a.getAttribute("data-videourl"));b.set("videoImageUrl",a.getAttribute("data-videoimageurl"));
b.set("relatedProductsAsins",a.getAttribute("data-relatedproductsasins"));b.set("formattedDuration",a.getAttribute("data-formattedduration"));b.set("publicName",a.getAttribute("data-publicname"));b.set("profileLink",a.getAttribute("data-profilelink"));b.set("profileImageUrl",a.getAttribute("data-profileimageurl"));b.set("vendorTrackingId",a.getAttribute("data-vendortrackingid"));return b},ba=function(a){h={requester:"HCTPExpertReviews",clientPrefix:"hctp-expert-reviews",page:"DetailPage",placement:"ReviewsSection",
device:w()?"Mobile":"Desktop",videoDataList:[],video:null,product:{contentID:"",contentIDType:"ASIN"}};a.forEach(function(b){b=J(b);h.videoDataList.push({contentId:b.get("asin"),metadata:{asin:b.get("asin"),videoImageHeight:b.get("videoImageHeight"),videoImageWidth:b.get("videoImageWidth"),videoImagePhysicalId:b.get("videoImagePhysicalId"),videoImageExtension:b.get("videoImageExtension"),title:b.get("title"),referenceId:b.get("referenceId"),videoURL:b.get("videoURL"),videoImageUrl:b.get("videoImageUrl"),
relatedProductsAsins:b.get("relatedProductsAsins"),formattedDuration:b.get("formattedDuration"),vendorTrackingId:b.get("vendorTrackingId"),publicName:b.get("publicName"),profileLink:b.get("profileLink"),profileImageUrl:b.get("profileImageUrl")}})});h.video={contentID:h.videoDataList[0].metadata.asin,contentIDType:"ASIN",videoURL:h.videoDataList[0].metadata.videoURL,imageURL:h.videoDataList[0].metadata.videoImageUrl,videoTitle:h.videoDataList[0].metadata.title,vendorTrackingId:h.videoDataList[0].metadata.vendorTrackingId};
h.product.contentID=h.videoDataList[0].metadata.asin},ea=function(){f["default"].on("a:popover:beforeHide:vse-hctp-expert-reviews-popover",function(){f["default"].trigger("vse:hctp-expert-reviews:page:lightBoxClosed")});var a=0;f["default"].on("a:popover:afterShow:vse-hctp-expert-reviews-popover",function(b){try{a++,w()||f["default"].$(b.popover.$popover).addClass("vse-vertical-lightbox vse-lightbox-wrapper vse-helpful-votes vse-ns-lightbox vse-rvs-v2 vse-lb-show-related-products vse-share-widget vse-responsive-lightbox vse-lb-v2 a-section"),
1==a&&(u&&u.refresh(),f["default"].$(b.popover.$popover).addClass("vse-remove-absolute"))}catch(c){q["default"].log("Exception in popover after show hander: "+c,"ERROR")}})},fa=function(a,b){a(n.videoIngressTrigger,"click",function(c){c=c.currentTarget;if(null!=c)a:{c=J(c),I={contentId:c.get("asin"),duration:c.get("formattedDuration"),imageUrl:c.get("videoImageUrl"),index:0,profileImageUrl:c.get("profileImageUrl"),profileLink:c.get("profileLink"),refTag:"vse_hctp_er_btf",relatedProducts:c.get("relatedProductsAsins"),
title:c.get("title"),vendorName:c.get("publicName"),vendorTrackingId:c.get("vendorTrackingId"),videoUrl:c.get("videoURL")},f["default"].$("#vse-expert-reviews-lightbox-container").css({opacity:1});if(w())f["default"].trigger("vse:cards:expert-reviews:secondary:view:open");else{u=Y["default"].get(f["default"].$("#expert-reviews-vse-popover-trigger"));if(f["default"].objectIsEmpty(u))break a;u.show()}c={assetSpec:I,lightBoxId:"vse-expert-reviews-lightbox-container"};f["default"].$("#videoBlockSpinner").addClass("aok-hidden");
f["default"].trigger("vse:hctp-expert-reviews:page:lightBoxOpened",c)}});v["default"].cardRoot.querySelectorAll(".video-containers").forEach(function(c){b(n.videoIngressTrigger,c)})};A._operationNames=[];A.card=function(){return l.__awaiter(void 0,void 0,void 0,function(){var a,b,c;return l.__generator(this,function(d){try{a=V["default"].setup(),b=a.define,c=a.attach,"desktop"===(C()?r.MSHOP:w()&&!C()?r.MWEB:r.DESKTOP)?Z(v["default"].cardRoot,b,c):aa(v["default"].cardRoot,b,c),da(v["default"].cardRoot),
fa(b,c),ea()}catch(e){q["default"].log("Exception in HCTP:ER client side: "+e,"ERROR")}return[2]})})}});
